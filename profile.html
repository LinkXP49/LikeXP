<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Your NEX-LINK-XP Profile</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, #0f0c29 0%, #1a103f 50%, #000814 100%);
      color: #e0e0ff;
      min-height: 100vh;
      margin: 0;
      padding: 30px 20px;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: repeating-linear-gradient(to bottom, transparent 0, rgba(0,0,0,0.04) 1px, transparent 2px);
      pointer-events: none;
      opacity: 0.35;
      z-index: 9999;
    }

    .layout {
      display: flex;
      max-width: 1400px;
      margin: 0 auto;
      gap: 24px;
    }

    .sidebar {
      width: 260px;
      background: rgba(20,15,50,0.85);
      border-radius: 20px;
      padding: 24px 16px;
      border: 1px solid rgba(0,240,255,0.18);
      box-shadow: 0 0 50px #00f0ff60;
      height: fit-content;
      position: sticky;
      top: 30px;
    }

    .sidebar-item {
      padding: 14px 18px;
      margin: 8px 0;
      border-radius: 12px;
      color: #d0d0ff;
      display: flex;
      align-items: center;
      gap: 14px;
      transition: all 0.3s;
      cursor: pointer;
      font-size: 1.05rem;
    }

    .sidebar-item i {
      width: 24px;
      text-align: center;
      font-size: 1.3rem;
    }

    .sidebar-item.active,
    .sidebar-item:hover {
      background: rgba(0,255,157,0.18);
      color: #00ff9d;
      box-shadow: 0 0 25px rgba(0,255,157,0.35);
    }

    .sidebar-submenu {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.35s ease;
      padding-left: 40px;
      font-size: 0.95rem;
      color: #c0c0ff;
    }

    .sidebar-submenu.expanded {
      max-height: 200px;
    }

    .sidebar-submenu a,
    .sidebar-submenu button {
      display: block;
      padding: 10px 18px;
      color: inherit;
      text-decoration: none;
      background: none;
      border: none;
      width: 100%;
      text-align: left;
      cursor: pointer;
      transition: all 0.3s;
    }

    .sidebar-submenu a:hover,
    .sidebar-submenu button:hover {
      color: #00ff9d;
      background: rgba(0,255,157,0.1);
    }

    .main-content {
      flex: 1;
      background: rgba(20,15,50,0.85);
      border-radius: 20px;
      padding: 40px;
      border: 1px solid rgba(0,240,255,0.18);
      box-shadow: 0 0 50px #00f0ff60;
    }

    h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 3.2rem;
      color: #00f0ff;
      text-shadow: 0 0 20px #00f0ff, 0 0 40px #ff00aa;
      text-align: center;
      margin: 0 0 40px;
      letter-spacing: 2px;
    }

    .avatar-wrapper {
      text-align: center;
      margin: 40px 0 50px;
    }

    #avatar {
      width: 180px;
      height: 180px;
      margin: 0 auto 20px;
      clip-path: polygon(50% 0%, 93% 25%, 93% 75%, 50% 100%, 7% 75%, 7% 25%);
      border: 4px solid rgba(0,240,255,0.45);
      box-shadow: 0 0 45px rgba(0,240,255,0.55);
      display: block;
      object-fit: cover;
    }

    .profile-item {
      margin: 20px 0;
      font-size: 1.1rem;
    }

    .profile-item strong {
      color: #00ff9d;
      display: inline-block;
      width: 140px;
      font-weight: 600;
    }

    .social-connect {
      margin-top: 60px;
      text-align: center;
    }

    .social-connect h3 {
      color: #00ff9d;
      margin-bottom: 30px;
      font-size: 1.5rem;
      text-shadow: 0 0 15px rgba(0,255,157,0.5);
    }

    .socials {
      display: flex;
      justify-content: center;
      gap: 28px;
      flex-wrap: wrap;
    }

    .socials a {
      width: 72px;
      height: 72px;
      border-radius: 18px;
      background: rgba(0,255,157,0.2);
      color: #00ff9d;
      font-size: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.35s;
      box-shadow: 0 0 20px rgba(0,255,157,0.3);
      text-decoration: none;
    }

    .socials a:hover {
      background: #00ff9d;
      color: #0a0a1f;
      transform: translateY(-8px);
      box-shadow: 0 0 50px #00ff9d90;
    }

    @media (max-width: 980px) {
      .layout { flex-direction: column; }
      .sidebar { width: 100%; position: static; }
    }
  </style>
</head>
<body>

  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-item active"><i class="fas fa-user"></i> Profile</div>
      <div class="sidebar-item"><i class="fas fa-home"></i> Home</div>
      <div class="sidebar-item"><i class="fas fa-envelope"></i> Messages</div>
      <div class="sidebar-item"><i class="fas fa-bell"></i> Notifications</div>
      
      <div class="sidebar-item" id="settings-toggle">
        <i class="fas fa-cog"></i> Settings
        <i class="fas fa-chevron-down" style="margin-left:auto; transition: transform 0.3s;"></i>
      </div>
      <div class="sidebar-submenu" id="settings-submenu">
        <a href="profile-edit.html">Edit Profile</a>
        <button onclick="logout()">Logout</button>
      </div>
    </aside>

    <main class="main-content" id="profileContainer">
      <!-- Content filled by JS below -->
    </main>
  </div>

  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <script>
    // Auth guard
    const loggedInUser = localStorage.getItem("loggedInUser");
    const profile = JSON.parse(localStorage.getItem("userProfile") || "null");

    if (!loggedInUser) {
      window.location.href = "login.html";
    }
    if (!profile) {
      window.location.href = "profile-edit.html";
    }

    // Save avatar for other pages if needed
    if (profile.avatar) {
      localStorage.setItem("profileAvatar", profile.avatar);
    }

    // Build dynamic social icons
    let socialsHTML = '';
    if (profile.youtube)   socialsHTML += `<a href="${profile.youtube}"   target="_blank"><i class="fab fa-youtube"></i></a>`;
    if (profile.x)         socialsHTML += `<a href="${profile.x}"         target="_blank"><i class="fab fa-x-twitter"></i></a>`;
    if (profile.discord)   socialsHTML += `<a href="#" target="_blank"><i class="fab fa-discord"></i></a>`;
    if (profile.twitch)    socialsHTML += `<a href="${profile.twitch}"    target="_blank"><i class="fab fa-twitch"></i></a>`;
    if (profile.instagram) socialsHTML += `<a href="${profile.instagram}" target="_blank"><i class="fab fa-instagram"></i></a>`;
    if (profile.tiktok)    socialsHTML += `<a href="${profile.tiktok}"    target="_blank"><i class="fab fa-tiktok"></i></a>`;

    // Build the full view-only HTML
    document.getElementById("profileContainer").innerHTML = `
      <h1>NEX-LINK-XP</h1>

      <div class="avatar-wrapper">
        ${profile.avatar 
          ? `<img id="avatar" src="${profile.avatar}" alt="Avatar">` 
          : '<div style="width:180px;height:180px;background:#222;border-radius:50%;margin:0 auto;"></div>'}
      </div>

      <div class="profile-item"><strong>Username:</strong> ${profile.username || '-'}</div>
      <div class="profile-item"><strong>Gamer Tag:</strong> ${profile.gamertag || '-'}</div>
      <div class="profile-item"><strong>Age:</strong> ${profile.age || '-'}</div>
      <div class="profile-item"><strong>Bio:</strong><br>${profile.bio || '-'}</div>

      ${socialsHTML ? `
        <div class="social-connect">
          <h3>Connected Social Media</h3>
          <div class="socials">${socialsHTML}</div>
        </div>
      ` : ''}
    `;

    // Settings dropdown toggle
    const settingsToggle = document.getElementById('settings-toggle');
    const settingsSubmenu = document.getElementById('settings-submenu');
    const chevron = settingsToggle?.querySelector('.fa-chevron-down');

    if (settingsToggle && settingsSubmenu) {
      settingsToggle.addEventListener('click', () => {
        settingsSubmenu.classList.toggle('expanded');
        if (chevron) {
          chevron.style.transform = settingsSubmenu.classList.contains('expanded') 
            ? 'rotate(180deg)' 
            : 'rotate(0deg)';
        }
      });
    }

    // Logout function
    function logout() {
      localStorage.removeItem("loggedInUser");
      window.location.href = "login.html";
    }
  </script>

</body>
</html>
